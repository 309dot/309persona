# 교란 방지 & 보안 전략

## 1. 기술적 방어

- **질문 전처리 필터**: `question_filter.validate_question`이 금지 패턴(`탈옥`, `ignore instructions` 등)을 탐지하고, 309와 무관한 질문은 즉시 차단 메시지를 반환합니다.
- **시스템 프롬프트 고정**: `app/prompts/system_prompt.txt`에 역할과 답변 톤을 명시하고, 지식베이스 외 내용을 만들지 않도록 명령합니다.
- **LLM 컨텍스트 제한**: `knowledge_base/309_knowledge_pack.json`만 컨텍스트에 주입하여 데이터 유출을 차단합니다.
- **Rate Limiting**: 세션당 `MAX_SESSION_QUESTIONS` 만큼만 질문 가능하도록 슬라이딩 윈도우 제한을 적용합니다.
- **Firebase Auth + Allowlist**: 대시보드 접근은 Firebase ID Token 검증 후 `ADMIN_ALLOWED_EMAILS`와 대조합니다.

## 2. UX 기반 방어

- 입장 화면에서 질문 허용 범위를 명확히 설명하고, 추천 카테고리를 제공해 사용 목적을 고정합니다.
- 자유 입력 영역에는 “309의 경력과 협업 방식 관련 질문만 가능” 메시지를 표시합니다.
- 차단 시도 시에는 동일한 문구로 안내하여 반복 시도를 억제합니다.

## 3. 심리적 방어

- 서비스 헤더와 안내문 모두 “면접 준비용 309 전용 에이전트”임을 강조해 범용 챗봇 기대값을 줄입니다.
- Follow-up 가이드와 하이라이트 목록으로 “깊이 있는 질문”을 유도해 탈옥 동기를 낮춥니다.

## 4. 향후 확장 아이디어

- Cloud Functions를 이용해 이상 트래픽을 감지하고 세션을 차단
- 질문 로그에 대한 간단한 분류 모델을 붙여 교란 시그널 자동 태깅
- 프론트엔드에서 카테고리 선택 후에만 자유 입력을 허용하는 “guided prompt” 모드


